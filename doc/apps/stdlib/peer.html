<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.32.2">
    <meta name="project" content="stdlib v6.0">


<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=27&q=">
<meta name="major-vsn" content="27">
    <title>peer â€” stdlib v6.0</title>
    <link rel="stylesheet" href="dist/html-erlang-EBZIIHAS.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-E02D3D15.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-BHYOTRCH.js"></script>


  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="stdlib" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
stdlib
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v6.0
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of stdlib</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L41" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

    <span translate="no">peer</span> 
    <small class="app-vsn" translate="no">(stdlib v6.0)</small>

  </h1>


    <section id="moduledoc">
<p>Start and control linked Erlang nodes.</p><p>This module provides functions for starting linked Erlang nodes. The node
spawning new nodes is called <em>origin</em>, and newly started nodes are <em>peer</em> nodes,
or peers. A peer node automatically terminates when it loses the <em>control
connection</em> to the origin. This connection could be an Erlang distribution
connection, or an alternative - TCP or standard I/O. The alternative connection
provides a way to execute remote procedure calls even when Erlang Distribution
is not available, allowing to test the distribution itself.</p><p>Peer node terminal input/output is relayed through the origin. If a standard I/O
alternative connection is requested, console output also goes via the origin,
allowing debugging of node startup and boot script execution (see
<a href="../../apps/erts/erl_cmd.html#init_debug"><code class="inline">-init_debug</code></a>). File I/O is not redirected,
contrary to <a href="slave.html"><code class="inline">slave</code></a> behaviour.</p><p>The peer node can start on the same or a different host (via <code class="inline">ssh</code>) or in a
separate container (for example Docker). When the peer starts on the same host
as the origin, it inherits the current directory and environment variables from
the origin.</p><blockquote><h4 class="info">Note</h4><p>This module is designed to facilitate multi-node testing with Common Test. Use
the <code class="inline">?CT_PEER()</code> macro to start a linked peer node according to Common Test
conventions: crash dumps written to specific location, node name prefixed with
module name, calling function, and origin OS process ID). Use <a href="#random_name/1"><code class="inline">random_name/1</code></a>
to create sufficiently unique node names if you need more control.</p><p>A peer node started without alternative connection behaves similarly to
<a href="slave.html"><code class="inline">slave</code></a>. When an alternative connection is requested, the behaviour is
similar to <code class="inline">test_server:start_node(Name, peer, Args).</code></p></blockquote><h2 id="module-example" class="section-heading">
  <a href="#module-example" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Example</span>
</h2>
<p>The following example implements a test suite starting extra Erlang nodes. It
employs a number of techniques to speed up testing and reliably shut down peer
nodes:</p><ul><li>peers start linked to test runner process. If the test case fails, the peer
node is stopped automatically, leaving no rogue nodes running in the
background</li><li>arguments used to start the peer are saved in the control process state for
manual analysis. If the test case fails, the CRASH REPORT contains these
arguments</li><li>multiple test cases can run concurrently speeding up overall testing process,
peer node names are unique even when there are multiple instances of the same
test suite running in parallel</li></ul><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="9706435180-1">(</span><span class="ss">my_SUITE</span><span class="p" data-group-id="9706435180-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">behaviour</span><span class="p" data-group-id="9706435180-2">(</span><span class="ss">ct_suite</span><span class="p" data-group-id="9706435180-2">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="9706435180-3">(</span><span class="p" data-group-id="9706435180-4">[</span><span class="ss">all</span><span class="p">/</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="ss">groups</span><span class="p">/</span><span class="mi">0</span><span class="p" data-group-id="9706435180-4">]</span><span class="p" data-group-id="9706435180-3">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="9706435180-5">(</span><span class="p" data-group-id="9706435180-6">[</span><span class="ss">basic</span><span class="p">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">args</span><span class="p">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">named</span><span class="p">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">restart_node</span><span class="p">/</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">multi_node</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="9706435180-6">]</span><span class="p" data-group-id="9706435180-5">)</span><span class="p">.</span><span class="w">
</span><span class="w">
</span><span class="p">-</span><span class="na">include_lib</span><span class="p" data-group-id="9706435180-7">(</span><span class="s">&quot;common_test/include/ct.hrl&quot;</span><span class="p" data-group-id="9706435180-7">)</span><span class="p">.</span><span class="w">

</span><span class="nf">groups</span><span class="p" data-group-id="9706435180-8">(</span><span class="p" data-group-id="9706435180-8">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="9706435180-9">[</span><span class="p" data-group-id="9706435180-10">{</span><span class="ss">quick</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9706435180-11">[</span><span class="ss">parallel</span><span class="p" data-group-id="9706435180-11">]</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="9706435180-12">[</span><span class="ss">basic</span><span class="p">,</span><span class="w"> </span><span class="ss">args</span><span class="p">,</span><span class="w"> </span><span class="ss">named</span><span class="p">,</span><span class="w"> </span><span class="ss">restart_node</span><span class="p">,</span><span class="w"> </span><span class="ss">multi_node</span><span class="p" data-group-id="9706435180-12">]</span><span class="p" data-group-id="9706435180-10">}</span><span class="p" data-group-id="9706435180-9">]</span><span class="p">.</span><span class="w">

</span><span class="nf">all</span><span class="p" data-group-id="9706435180-13">(</span><span class="p" data-group-id="9706435180-13">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="9706435180-14">[</span><span class="p" data-group-id="9706435180-15">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">quick</span><span class="p" data-group-id="9706435180-15">}</span><span class="p" data-group-id="9706435180-14">]</span><span class="p">.</span><span class="w">

</span><span class="nf">basic</span><span class="p" data-group-id="9706435180-16">(</span><span class="n">Config</span><span class="p" data-group-id="9706435180-16">)</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="nf">is_list</span><span class="p" data-group-id="9706435180-17">(</span><span class="n">Config</span><span class="p" data-group-id="9706435180-17">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="9706435180-18">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Peer</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="n">Node</span><span class="p" data-group-id="9706435180-18">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="n">CT_PEER</span><span class="p" data-group-id="9706435180-19">(</span><span class="p" data-group-id="9706435180-19">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">peer</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="9706435180-20">(</span><span class="n">Peer</span><span class="p" data-group-id="9706435180-20">)</span><span class="p">.</span><span class="w">

</span><span class="nf">args</span><span class="p" data-group-id="9706435180-21">(</span><span class="n">Config</span><span class="p" data-group-id="9706435180-21">)</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="nf">is_list</span><span class="p" data-group-id="9706435180-22">(</span><span class="n">Config</span><span class="p" data-group-id="9706435180-22">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% specify additional arguments to the new node</span><span class="w">
    </span><span class="p" data-group-id="9706435180-23">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Peer</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="n">Node</span><span class="p" data-group-id="9706435180-23">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="n">CT_PEER</span><span class="p" data-group-id="9706435180-24">(</span><span class="p" data-group-id="9706435180-25">[</span><span class="s">&quot;-emu_flavor&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;smp&quot;</span><span class="p" data-group-id="9706435180-25">]</span><span class="p" data-group-id="9706435180-24">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">peer</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="9706435180-26">(</span><span class="n">Peer</span><span class="p" data-group-id="9706435180-26">)</span><span class="p">.</span><span class="w">

</span><span class="nf">named</span><span class="p" data-group-id="9706435180-27">(</span><span class="n">Config</span><span class="p" data-group-id="9706435180-27">)</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="nf">is_list</span><span class="p" data-group-id="9706435180-28">(</span><span class="n">Config</span><span class="p" data-group-id="9706435180-28">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% pass test case name down to function starting nodes</span><span class="w">
    </span><span class="n">Peer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">start_node_impl</span><span class="p" data-group-id="9706435180-29">(</span><span class="ss">named_test</span><span class="p" data-group-id="9706435180-29">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">peer</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="9706435180-30">(</span><span class="n">Peer</span><span class="p" data-group-id="9706435180-30">)</span><span class="p">.</span><span class="w">

</span><span class="nf">start_node_impl</span><span class="p" data-group-id="9706435180-31">(</span><span class="n">ActualTestCase</span><span class="p" data-group-id="9706435180-31">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="9706435180-32">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Peer</span><span class="p">,</span><span class="w"> </span><span class="n">Node</span><span class="p" data-group-id="9706435180-32">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="n">CT_PEER</span><span class="p" data-group-id="9706435180-33">(</span><span class="p" data-group-id="9706435180-34">#{</span><span class="ss">name</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">?</span><span class="n">CT_PEER_NAME</span><span class="p" data-group-id="9706435180-35">(</span><span class="n">ActualTestCase</span><span class="p" data-group-id="9706435180-35">)</span><span class="p" data-group-id="9706435180-34">}</span><span class="p" data-group-id="9706435180-33">)</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% extra setup needed for multiple test cases</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">rpc</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="9706435180-36">(</span><span class="n">Node</span><span class="p">,</span><span class="w"> </span><span class="ss">application</span><span class="p">,</span><span class="w"> </span><span class="ss">set_env</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9706435180-37">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">key</span><span class="p">,</span><span class="w"> </span><span class="ss">value</span><span class="p" data-group-id="9706435180-37">]</span><span class="p" data-group-id="9706435180-36">)</span><span class="p">,</span><span class="w">
    </span><span class="n">Peer</span><span class="p">.</span><span class="w">

</span><span class="nf">restart_node</span><span class="p" data-group-id="9706435180-38">(</span><span class="n">Config</span><span class="p" data-group-id="9706435180-38">)</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="nf">is_list</span><span class="p" data-group-id="9706435180-39">(</span><span class="n">Config</span><span class="p" data-group-id="9706435180-39">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="n">CT_PEER_NAME</span><span class="p" data-group-id="9706435180-40">(</span><span class="p" data-group-id="9706435180-40">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="9706435180-41">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Peer</span><span class="p">,</span><span class="w"> </span><span class="n">Node</span><span class="p" data-group-id="9706435180-41">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="n">CT_PEER</span><span class="p" data-group-id="9706435180-42">(</span><span class="p" data-group-id="9706435180-43">#{</span><span class="ss">name</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Name</span><span class="p" data-group-id="9706435180-43">}</span><span class="p" data-group-id="9706435180-42">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">peer</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="9706435180-44">(</span><span class="n">Peer</span><span class="p" data-group-id="9706435180-44">)</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% restart the node with the same name as before</span><span class="w">
    </span><span class="p" data-group-id="9706435180-45">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Peer2</span><span class="p">,</span><span class="w"> </span><span class="n">Node</span><span class="p" data-group-id="9706435180-45">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="n">CT_PEER</span><span class="p" data-group-id="9706435180-46">(</span><span class="p" data-group-id="9706435180-47">#{</span><span class="ss">name</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="ss">args</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="9706435180-48">[</span><span class="s">&quot;+fnl&quot;</span><span class="p" data-group-id="9706435180-48">]</span><span class="p" data-group-id="9706435180-47">}</span><span class="p" data-group-id="9706435180-46">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">peer</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="9706435180-49">(</span><span class="n">Peer2</span><span class="p" data-group-id="9706435180-49">)</span><span class="p">.</span></code></pre><p>The next example demonstrates how to start multiple nodes concurrently:</p><pre><code class="makeup erlang" translate="no"><span class="nf">multi_node</span><span class="p" data-group-id="4739945327-1">(</span><span class="n">Config</span><span class="p" data-group-id="4739945327-1">)</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="nf">is_list</span><span class="p" data-group-id="4739945327-2">(</span><span class="n">Config</span><span class="p" data-group-id="4739945327-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Peers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4739945327-3">[</span><span class="o">?</span><span class="n">CT_PEER</span><span class="p" data-group-id="4739945327-4">(</span><span class="p" data-group-id="4739945327-5">#{</span><span class="ss">wait_boot</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="4739945327-6">{</span><span class="nf">self</span><span class="p" data-group-id="4739945327-7">(</span><span class="p" data-group-id="4739945327-7">)</span><span class="p">,</span><span class="w"> </span><span class="ss">tag</span><span class="p" data-group-id="4739945327-6">}</span><span class="p" data-group-id="4739945327-5">}</span><span class="p" data-group-id="4739945327-4">)</span><span class="w">
        </span><span class="p">||</span><span class="w"> </span><span class="p">_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">lists</span><span class="p">:</span><span class="nf">seq</span><span class="p" data-group-id="4739945327-8">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p" data-group-id="4739945327-8">)</span><span class="p" data-group-id="4739945327-3">]</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% wait for all nodes to complete boot process, get their names:</span><span class="w">
    </span><span class="p">_</span><span class="n">Nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4739945327-9">[</span><span class="k">receive</span><span class="w"> </span><span class="p" data-group-id="4739945327-10">{</span><span class="ss">tag</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4739945327-11">{</span><span class="ss">started</span><span class="p">,</span><span class="w"> </span><span class="n">Node</span><span class="p">,</span><span class="w"> </span><span class="n">Peer</span><span class="p" data-group-id="4739945327-11">}</span><span class="p" data-group-id="4739945327-10">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="k">end</span><span class="w">
        </span><span class="p">||</span><span class="w"> </span><span class="p" data-group-id="4739945327-12">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Peer</span><span class="p" data-group-id="4739945327-12">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Peers</span><span class="p" data-group-id="4739945327-9">]</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4739945327-13">[</span><span class="nc">peer</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="4739945327-14">(</span><span class="n">Peer</span><span class="p" data-group-id="4739945327-14">)</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="p" data-group-id="4739945327-15">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Peer</span><span class="p" data-group-id="4739945327-15">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Peers</span><span class="p" data-group-id="4739945327-13">]</span><span class="p">.</span></code></pre><p>Start a peer on a different host. Requires <code class="inline">ssh</code> key-based authentication set
up, allowing &quot;another_host&quot; connection without password prompt.</p><pre><code class="makeup erlang" translate="no"><span class="n">Ssh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">os</span><span class="p">:</span><span class="nf">find_executable</span><span class="p" data-group-id="7378682825-1">(</span><span class="s">&quot;ssh&quot;</span><span class="p" data-group-id="7378682825-1">)</span><span class="p">,</span><span class="w">
</span><span class="nc">peer</span><span class="p">:</span><span class="nf">start_link</span><span class="p" data-group-id="7378682825-2">(</span><span class="p" data-group-id="7378682825-3">#{</span><span class="ss">exec</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="7378682825-4">{</span><span class="n">Ssh</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7378682825-5">[</span><span class="s">&quot;another_host&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;erl&quot;</span><span class="p" data-group-id="7378682825-5">]</span><span class="p" data-group-id="7378682825-4">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">connection</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">standard_io</span><span class="p" data-group-id="7378682825-3">}</span><span class="p" data-group-id="7378682825-2">)</span><span class="p">,</span></code></pre><p>The following Common Test case demonstrates Docker integration, starting two
containers with hostnames &quot;one&quot; and &quot;two&quot;. In this example Erlang nodes running
inside containers form an Erlang cluster.</p><pre><code class="makeup erlang" translate="no"><span class="nf">docker</span><span class="p" data-group-id="8788600962-1">(</span><span class="n">Config</span><span class="p" data-group-id="8788600962-1">)</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="nf">is_list</span><span class="p" data-group-id="8788600962-2">(</span><span class="n">Config</span><span class="p" data-group-id="8788600962-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Docker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">os</span><span class="p">:</span><span class="nf">find_executable</span><span class="p" data-group-id="8788600962-3">(</span><span class="s">&quot;docker&quot;</span><span class="p" data-group-id="8788600962-3">)</span><span class="p">,</span><span class="w">
    </span><span class="n">PrivDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">proplists</span><span class="p">:</span><span class="nf">get_value</span><span class="p" data-group-id="8788600962-4">(</span><span class="ss">priv_dir</span><span class="p">,</span><span class="w"> </span><span class="n">Config</span><span class="p" data-group-id="8788600962-4">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">build_release</span><span class="p" data-group-id="8788600962-5">(</span><span class="n">PrivDir</span><span class="p" data-group-id="8788600962-5">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">build_image</span><span class="p" data-group-id="8788600962-6">(</span><span class="n">PrivDir</span><span class="p" data-group-id="8788600962-6">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% start two Docker containers</span><span class="w">
    </span><span class="p" data-group-id="8788600962-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Peer</span><span class="p">,</span><span class="w"> </span><span class="n">Node</span><span class="p" data-group-id="8788600962-7">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">peer</span><span class="p">:</span><span class="nf">start_link</span><span class="p" data-group-id="8788600962-8">(</span><span class="p" data-group-id="8788600962-9">#{</span><span class="ss">name</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">lambda</span><span class="p">,</span><span class="w">
        </span><span class="ss">connection</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">standard_io</span><span class="p">,</span><span class="w">
        </span><span class="ss">exec</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="8788600962-10">{</span><span class="n">Docker</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-11">[</span><span class="s">&quot;run&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;-h&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;one&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;-i&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lambda&quot;</span><span class="p" data-group-id="8788600962-11">]</span><span class="p" data-group-id="8788600962-10">}</span><span class="p" data-group-id="8788600962-9">}</span><span class="p" data-group-id="8788600962-8">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="8788600962-12">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Peer2</span><span class="p">,</span><span class="w"> </span><span class="n">Node2</span><span class="p" data-group-id="8788600962-12">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">peer</span><span class="p">:</span><span class="nf">start_link</span><span class="p" data-group-id="8788600962-13">(</span><span class="p" data-group-id="8788600962-14">#{</span><span class="ss">name</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">lambda</span><span class="p">,</span><span class="w">
        </span><span class="ss">connection</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">standard_io</span><span class="p">,</span><span class="w">
        </span><span class="ss">exec</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="8788600962-15">{</span><span class="n">Docker</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-16">[</span><span class="s">&quot;run&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;-h&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;two&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;-i&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lambda&quot;</span><span class="p" data-group-id="8788600962-16">]</span><span class="p" data-group-id="8788600962-15">}</span><span class="p" data-group-id="8788600962-14">}</span><span class="p" data-group-id="8788600962-13">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% find IP address of the second node using alternative connection RPC</span><span class="w">
    </span><span class="p" data-group-id="8788600962-17">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Ips</span><span class="p" data-group-id="8788600962-17">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">peer</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="8788600962-18">(</span><span class="n">Peer2</span><span class="p">,</span><span class="w"> </span><span class="ss">inet</span><span class="p">,</span><span class="w"> </span><span class="ss">getifaddrs</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-19">[</span><span class="p" data-group-id="8788600962-19">]</span><span class="p" data-group-id="8788600962-18">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="8788600962-20">{</span><span class="s">&quot;eth0&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Eth0</span><span class="p" data-group-id="8788600962-20">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">lists</span><span class="p">:</span><span class="nf">keyfind</span><span class="p" data-group-id="8788600962-21">(</span><span class="s">&quot;eth0&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ips</span><span class="p" data-group-id="8788600962-21">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="8788600962-22">{</span><span class="ss">addr</span><span class="p">,</span><span class="w"> </span><span class="n">Ip</span><span class="p" data-group-id="8788600962-22">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">lists</span><span class="p">:</span><span class="nf">keyfind</span><span class="p" data-group-id="8788600962-23">(</span><span class="ss">addr</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Eth0</span><span class="p" data-group-id="8788600962-23">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% make first node to discover second one</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">peer</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="8788600962-24">(</span><span class="n">Peer</span><span class="p">,</span><span class="w"> </span><span class="ss">inet_db</span><span class="p">,</span><span class="w"> </span><span class="ss">set_lookup</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-25">[</span><span class="p" data-group-id="8788600962-26">[</span><span class="ss">file</span><span class="p" data-group-id="8788600962-26">]</span><span class="p" data-group-id="8788600962-25">]</span><span class="p" data-group-id="8788600962-24">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">peer</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="8788600962-27">(</span><span class="n">Peer</span><span class="p">,</span><span class="w"> </span><span class="ss">inet_db</span><span class="p">,</span><span class="w"> </span><span class="ss">add_host</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-28">[</span><span class="n">Ip</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-29">[</span><span class="s">&quot;two&quot;</span><span class="p" data-group-id="8788600962-29">]</span><span class="p" data-group-id="8788600962-28">]</span><span class="p" data-group-id="8788600962-27">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% join a cluster</span><span class="w">
    </span><span class="ss">true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">peer</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="8788600962-30">(</span><span class="n">Peer</span><span class="p">,</span><span class="w"> </span><span class="ss">net_kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">connect_node</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-31">[</span><span class="n">Node2</span><span class="p" data-group-id="8788600962-31">]</span><span class="p" data-group-id="8788600962-30">)</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% verify that second peer node has only the first node visible</span><span class="w">
    </span><span class="p" data-group-id="8788600962-32">[</span><span class="n">Node</span><span class="p" data-group-id="8788600962-32">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">peer</span><span class="p">:</span><span class="nf">call</span><span class="p" data-group-id="8788600962-33">(</span><span class="n">Peer2</span><span class="p">,</span><span class="w"> </span><span class="ss">erlang</span><span class="p">,</span><span class="w"> </span><span class="nb">nodes</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-34">[</span><span class="p" data-group-id="8788600962-34">]</span><span class="p" data-group-id="8788600962-33">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% stop peers, causing containers to also stop</span><span class="w">
    </span><span class="nc">peer</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="8788600962-35">(</span><span class="n">Peer2</span><span class="p" data-group-id="8788600962-35">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">peer</span><span class="p">:</span><span class="nf">stop</span><span class="p" data-group-id="8788600962-36">(</span><span class="n">Peer</span><span class="p" data-group-id="8788600962-36">)</span><span class="p">.</span><span class="w">

</span><span class="nf">build_release</span><span class="p" data-group-id="8788600962-37">(</span><span class="n">Dir</span><span class="p" data-group-id="8788600962-37">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% load sasl.app file, otherwise application:get_key will fail</span><span class="w">
    </span><span class="nc">application</span><span class="p">:</span><span class="nf">load</span><span class="p" data-group-id="8788600962-38">(</span><span class="ss">sasl</span><span class="p" data-group-id="8788600962-38">)</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% create *.rel - release file</span><span class="w">
    </span><span class="n">RelFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">filename</span><span class="p">:</span><span class="nf">join</span><span class="p" data-group-id="8788600962-39">(</span><span class="n">Dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lambda.rel&quot;</span><span class="p" data-group-id="8788600962-39">)</span><span class="p">,</span><span class="w">
    </span><span class="n">Release</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="8788600962-40">{</span><span class="ss">release</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-41">{</span><span class="s">&quot;lambda&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1.0.0&quot;</span><span class="p" data-group-id="8788600962-41">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="8788600962-42">{</span><span class="ss">erts</span><span class="p">,</span><span class="w"> </span><span class="nc">erlang</span><span class="p">:</span><span class="nf">system_info</span><span class="p" data-group-id="8788600962-43">(</span><span class="ss">version</span><span class="p" data-group-id="8788600962-43">)</span><span class="p" data-group-id="8788600962-42">}</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="8788600962-44">[</span><span class="p" data-group-id="8788600962-45">{</span><span class="n">App</span><span class="p">,</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="p" data-group-id="8788600962-46">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Vsn</span><span class="p" data-group-id="8788600962-46">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">application</span><span class="p">:</span><span class="nf">get_key</span><span class="p" data-group-id="8788600962-47">(</span><span class="n">App</span><span class="p">,</span><span class="w"> </span><span class="ss">vsn</span><span class="p" data-group-id="8788600962-47">)</span><span class="p">,</span><span class="w"> </span><span class="n">Vsn</span><span class="w"> </span><span class="k">end</span><span class="p" data-group-id="8788600962-45">}</span><span class="w">
            </span><span class="p">||</span><span class="w"> </span><span class="n">App</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="8788600962-48">[</span><span class="ss">kernel</span><span class="p">,</span><span class="w"> </span><span class="ss">stdlib</span><span class="p">,</span><span class="w"> </span><span class="ss">sasl</span><span class="p" data-group-id="8788600962-48">]</span><span class="p" data-group-id="8788600962-44">]</span><span class="p" data-group-id="8788600962-40">}</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">file</span><span class="p">:</span><span class="nf">write_file</span><span class="p" data-group-id="8788600962-49">(</span><span class="n">RelFile</span><span class="p">,</span><span class="w"> </span><span class="nf">list_to_binary</span><span class="p" data-group-id="8788600962-50">(</span><span class="nc">lists</span><span class="p">:</span><span class="nf">flatten</span><span class="p" data-group-id="8788600962-51">(</span><span class="w">
        </span><span class="nc">io_lib</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="8788600962-52">(</span><span class="s">&quot;~tp.&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-53">[</span><span class="n">Release</span><span class="p" data-group-id="8788600962-53">]</span><span class="p" data-group-id="8788600962-52">)</span><span class="p" data-group-id="8788600962-51">)</span><span class="p" data-group-id="8788600962-50">)</span><span class="p" data-group-id="8788600962-49">)</span><span class="p">,</span><span class="w">
    </span><span class="n">RelFileNoExt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">filename</span><span class="p">:</span><span class="nf">join</span><span class="p" data-group-id="8788600962-54">(</span><span class="n">Dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lambda&quot;</span><span class="p" data-group-id="8788600962-54">)</span><span class="p">,</span><span class="w">

    </span><span class="c1">%% create boot script</span><span class="w">
    </span><span class="p" data-group-id="8788600962-55">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="ss">systools_make</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-56">[</span><span class="p" data-group-id="8788600962-56">]</span><span class="p" data-group-id="8788600962-55">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">systools</span><span class="p">:</span><span class="nf">make_script</span><span class="p" data-group-id="8788600962-57">(</span><span class="n">RelFileNoExt</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="8788600962-58">[</span><span class="ss">silent</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-59">{</span><span class="ss">outdir</span><span class="p">,</span><span class="w"> </span><span class="n">Dir</span><span class="p" data-group-id="8788600962-59">}</span><span class="p" data-group-id="8788600962-58">]</span><span class="p" data-group-id="8788600962-57">)</span><span class="p">,</span><span class="w">
    </span><span class="c1">%% package release into *.tar.gz</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">systools</span><span class="p">:</span><span class="nf">make_tar</span><span class="p" data-group-id="8788600962-60">(</span><span class="n">RelFileNoExt</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8788600962-61">[</span><span class="p" data-group-id="8788600962-62">{</span><span class="ss">erts</span><span class="p">,</span><span class="w"> </span><span class="nc">code</span><span class="p">:</span><span class="nf">root_dir</span><span class="p" data-group-id="8788600962-63">(</span><span class="p" data-group-id="8788600962-63">)</span><span class="p" data-group-id="8788600962-62">}</span><span class="p" data-group-id="8788600962-61">]</span><span class="p" data-group-id="8788600962-60">)</span><span class="p">.</span><span class="w">

</span><span class="nf">build_image</span><span class="p" data-group-id="8788600962-64">(</span><span class="n">Dir</span><span class="p" data-group-id="8788600962-64">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="c1">%% Create Dockerfile example, working only for Ubuntu 20.04</span><span class="w">
    </span><span class="c1">%% Expose port 4445, and make Erlang distribution to listen</span><span class="w">
    </span><span class="c1">%%  on this port, and connect to it without EPMD</span><span class="w">
    </span><span class="c1">%% Set cookie on both nodes to be the same.</span><span class="w">
    </span><span class="n">BuildScript</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">filename</span><span class="p">:</span><span class="nf">join</span><span class="p" data-group-id="8788600962-65">(</span><span class="n">Dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Dockerfile&quot;</span><span class="p" data-group-id="8788600962-65">)</span><span class="p">,</span><span class="w">
    </span><span class="n">Dockerfile</span><span class="w"> </span><span class="o">=</span><span class="w">
      </span><span class="s">&quot;FROM ubuntu:20.04 as runner\n&quot;</span><span class="w">
      </span><span class="s">&quot;EXPOSE 4445\n&quot;</span><span class="w">
      </span><span class="s">&quot;WORKDIR /opt/lambda\n&quot;</span><span class="w">
      </span><span class="s">&quot;COPY lambda.tar.gz /tmp\n&quot;</span><span class="w">
      </span><span class="s">&quot;RUN tar -zxvf /tmp/lambda.tar.gz -C /opt/lambda\n&quot;</span><span class="w">
      </span><span class="s">&quot;ENTRYPOINT [\&quot;/opt/lambda/erts-&quot;</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="nc">erlang</span><span class="p">:</span><span class="nf">system_info</span><span class="p" data-group-id="8788600962-66">(</span><span class="ss">version</span><span class="p" data-group-id="8788600962-66">)</span><span class="w"> </span><span class="o">++</span><span class="w">
      </span><span class="s">&quot;/bin/dyn_erl\&quot;, \&quot;-boot\&quot;, \&quot;/opt/lambda/releases/1.0.0/start\&quot;,&quot;</span><span class="w">
      </span><span class="s">&quot; \&quot;-kernel\&quot;, \&quot;inet_dist_listen_min\&quot;, \&quot;4445\&quot;,&quot;</span><span class="w">
      </span><span class="s">&quot; \&quot;-erl_epmd_port\&quot;, \&quot;4445\&quot;,&quot;</span><span class="w">
      </span><span class="s">&quot; \&quot;-setcookie\&quot;, \&quot;secret\&quot;]\n&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">file</span><span class="p">:</span><span class="nf">write_file</span><span class="p" data-group-id="8788600962-67">(</span><span class="n">BuildScript</span><span class="p">,</span><span class="w"> </span><span class="n">Dockerfile</span><span class="p" data-group-id="8788600962-67">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">os</span><span class="p">:</span><span class="nf">cmd</span><span class="p" data-group-id="8788600962-68">(</span><span class="s">&quot;docker build -t lambda &quot;</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">Dir</span><span class="p" data-group-id="8788600962-68">)</span><span class="p">.</span></code></pre>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:connection/0" data-no-tooltip translate="no">connection()</a>

      </div>

        <div class="summary-synopsis"><p>Alternative connection between the origin and the peer. When the connection
closes, the peer node terminates automatically.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:disconnect_timeout/0" data-no-tooltip translate="no">disconnect_timeout()</a>

      </div>

        <div class="summary-synopsis"><p>Disconnect timeout. See <a href="#stop/1"><code class="inline">stop()</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:exec/0" data-no-tooltip translate="no">exec()</a>

      </div>

        <div class="summary-synopsis"><p>Overrides executable to start peer nodes with.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:peer_state/0" data-no-tooltip translate="no">peer_state()</a>

      </div>

        <div class="summary-synopsis"><p>Peer node state.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:server_ref/0" data-no-tooltip translate="no">server_ref()</a>

      </div>

        <div class="summary-synopsis"><p>Identifies the controlling process of a peer node.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:start_options/0" data-no-tooltip translate="no">start_options()</a>

      </div>

        <div class="summary-synopsis"><p>Options that can be used when starting a <code class="inline">peer</code> node through <a href="#start/1"><code class="inline">start/1</code></a> and
<a href="#start_link/0"><code class="inline">start_link/0,1</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:wait_boot/0" data-no-tooltip translate="no">wait_boot()</a>

      </div>

        <div class="summary-synopsis"><p>Specifies start/start_link timeout in milliseconds. Can be set to <code class="inline">false</code>,
allowing the peer to start asynchronously. If <code class="inline">{Pid, Tag}</code> is specified instead
of a timeout, the peer will send <code class="inline">Tag</code> to the requested process.</p></div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#call/4" data-no-tooltip translate="no">call(Dest, Module, Function, Args)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a href="#call/5"><code class="inline">call(Dest, Module, Function, Args, 5000)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#call/5" data-no-tooltip translate="no">call(Dest, Module, Function, Args, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Uses the alternative connection to evaluate
<a href="../../apps/erts/erlang.html#apply/3"><code class="inline">apply(Module, Function, Args)</code></a> on the peer node and returns the
corresponding value <code class="inline">Result</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#cast/4" data-no-tooltip translate="no">cast(Dest, Module, Function, Args)</a>

      </div>

        <div class="summary-synopsis"><p>Uses the alternative connection to evaluate
<a href="../../apps/erts/erlang.html#apply/3"><code class="inline">apply(Module, Function, Args)</code></a> on the peer node. No response is
delivered to the calling process.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_state/1" data-no-tooltip translate="no">get_state(Dest)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the peer node state.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#random_name/0" data-no-tooltip translate="no">random_name()</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a href="#random_name/1"><code class="inline">random_name(peer)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#random_name/1" data-no-tooltip translate="no">random_name(Prefix)</a>

      </div>

        <div class="summary-synopsis"><p>Creates a sufficiently unique node name for the current host, combining a
prefix, a unique number, and the current OS process ID.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#send/3" data-no-tooltip translate="no">send(Dest, To, Message)</a>

      </div>

        <div class="summary-synopsis"><p>Uses the alternative connection to send Message to a process on the the peer node.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#start/1" data-no-tooltip translate="no">start(Options)</a>

      </div>

        <div class="summary-synopsis"><p>Starts a peer node with the specified <a href="#t:start_options/0"><code class="inline">start_options/0</code></a>. Returns the
controlling process and the full peer node name, unless <code class="inline">wait_boot</code> is not
requested and the host name is not known in advance.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#start_link/0" data-no-tooltip translate="no">start_link()</a>

      </div>

        <div class="summary-synopsis"><p>The same as <a href="#start_link/1"><code class="inline">start_link(#{name =&gt; random_name()})</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#start_link/1" data-no-tooltip translate="no">start_link(Options)</a>

      </div>

        <div class="summary-synopsis"><p>Starts a peer node in the same way as <a href="#start/1"><code class="inline">start/1</code></a>, except that the peer node is
linked to the currently executing process. If that process terminates, the peer
node also terminates.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#stop/1" data-no-tooltip translate="no">stop(Dest)</a>

      </div>

        <div class="summary-synopsis"><p>Stops a peer node. How the node is stopped depends on the
<a href="#t:start_options/0"><code class="inline">shutdown</code></a> option passed when starting the peer node.
Currently the following <code class="inline">shutdown</code> options are supported</p></div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:connection/0">

  <div class="detail-header">
    <a href="#t:connection/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">connection()</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L132" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(not exported)</span>

      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> connection() :: Port :: 0..65535 | {<a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>(), 0..65535} | standard_io.</pre>

      </div>

<p>Alternative connection between the origin and the peer. When the connection
closes, the peer node terminates automatically.</p><p>If the <code class="inline">peer_down</code> startup flag is set to <code class="inline">crash</code>, the controlling process on
the origin node exits with corresponding reason, effectively providing a two-way link.</p><p>When <code class="inline">connection</code> is set to a port number, the origin starts listening on the
requested TCP port, and the peer node connects to the port. When it is set to an
<code class="inline">{IP, Port}</code> tuple, the origin listens only on the specified IP. The port number
can be set to 0 for automatic selection.</p><p>Using the <code class="inline">standard_io</code> alternative connection starts the peer attached to the
origin (other connections use <code class="inline">-detached</code> flag to erl). In this mode peer and
origin communicate via stdin/stdout.</p>
  </section>
</section>
<section class="detail" id="t:disconnect_timeout/0">

  <div class="detail-header">
    <a href="#t:disconnect_timeout/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">disconnect_timeout()</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L301" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> disconnect_timeout() :: 1000..4294967295 | infinity.</pre>

      </div>

<p>Disconnect timeout. See <a href="#stop/1"><code class="inline">stop()</code></a>.</p>
  </section>
</section>
<section class="detail" id="t:exec/0">

  <div class="detail-header">
    <a href="#t:exec/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">exec()</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L168" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> exec() :: <a href="../../apps/kernel/file.html#t:name/0">file:name</a>() | {<a href="../../apps/kernel/file.html#t:name/0">file:name</a>(), [<a href="../../apps/erts/erlang.html#t:string/0">string</a>()]}.</pre>

      </div>

<p>Overrides executable to start peer nodes with.</p><p>By default it is the path to &quot;erl&quot;, taken from <code class="inline">init:get_argument(progname)</code>.
If <code class="inline">progname</code> is not known, <code class="inline">peer</code> makes best guess given the current ERTS version.</p><p>When a tuple is passed, the first element is the path to executable, and the
second element is prepended to the final command line. This can be used to start
peers on a remote host or in a Docker container. See the examples above.</p><p>This option is useful for testing backwards compatibility with previous
releases, installed at specific paths, or when the Erlang installation location
is missing from the <code class="inline">PATH</code>.</p>
  </section>
</section>
<section class="detail" id="t:peer_state/0">

  <div class="detail-header">
    <a href="#t:peer_state/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">peer_state()</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L262" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> peer_state() :: booting | running | {down, Reason :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>()}.</pre>

      </div>

<p>Peer node state.</p>
  </section>
</section>
<section class="detail" id="t:server_ref/0">

  <div class="detail-header">
    <a href="#t:server_ref/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">server_ref()</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L78" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> server_ref() :: <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>().</pre>

      </div>

<p>Identifies the controlling process of a peer node.</p>
  </section>
</section>
<section class="detail" id="t:start_options/0">

  <div class="detail-header">
    <a href="#t:start_options/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">start_options()</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L232" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> start_options() ::
          #{name => <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>() | <a href="../../apps/erts/erlang.html#t:string/0">string</a>(),
            longnames => <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>(),
            host => <a href="../../apps/erts/erlang.html#t:string/0">string</a>(),
            peer_down => stop | continue | crash,
            connection => <a href="#t:connection/0">connection</a>(),
            exec => <a href="#t:exec/0">exec</a>(),
            detached => <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>(),
            args => [<a href="../../apps/erts/erlang.html#t:string/0">string</a>()],
            post_process_args => fun(([<a href="../../apps/erts/erlang.html#t:string/0">string</a>()]) -> [<a href="../../apps/erts/erlang.html#t:string/0">string</a>()]),
            env => [{<a href="../../apps/erts/erlang.html#t:string/0">string</a>(), <a href="../../apps/erts/erlang.html#t:string/0">string</a>()}],
            wait_boot => <a href="#t:wait_boot/0">wait_boot</a>(),
            shutdown => close | halt | {halt, <a href="#t:disconnect_timeout/0">disconnect_timeout</a>()} | <a href="#t:disconnect_timeout/0">disconnect_timeout</a>()}.</pre>

      </div>

<p>Options that can be used when starting a <code class="inline">peer</code> node through <a href="#start/1"><code class="inline">start/1</code></a> and
<a href="#start_link/0"><code class="inline">start_link/0,1</code></a>.</p><ul><li><p><strong><code class="inline">name</code></strong> - Node name (the part before &quot;@&quot;). When <code class="inline">name</code> is not specified,
but <code class="inline">host</code> is, <code class="inline">peer</code> follows compatibility behaviour and uses the origin node
name.</p></li><li><p><strong><code class="inline">longnames</code></strong> - Use long names to start a node. Default is taken from the
origin using <code class="inline">net_kernel:longnames()</code>. If the origin is not distributed, short
names is the default.</p></li><li><p><strong><code class="inline">host</code></strong> - Enforces a specific host name. Can be used to override the
default behaviour and start &quot;node@localhost&quot; instead of &quot;node@realhostname&quot;.</p></li><li><p><strong><code class="inline">peer_down</code></strong> - Defines the peer control process behaviour when the control
connection is closed from the peer node side (for example when the peer
crashes or dumps core). When set to <code class="inline">stop</code> (default), a lost control
connection causes the control process to exit normally. Setting <code class="inline">peer_down</code> to
<code class="inline">continue</code> keeps the control process running, and <code class="inline">crash</code> will cause the
controlling process to exit abnormally.</p></li><li><p><strong><code class="inline">connection</code></strong> - Alternative connection specification. See the
<a href="#t:connection/0"><code class="inline">connection</code> datatype</a>.</p></li><li><p><strong><code class="inline">exec</code></strong> - Alternative mechanism to start peer nodes with, for example, ssh
instead of the default bash.</p></li><li><p><strong><code class="inline">detached</code></strong> - Defines whether to pass the <code class="inline">-detached</code> flag to the started
peer. This option cannot be set to <code class="inline">false</code> using the <code class="inline">standard_io</code> alternative
connection type. Default is <code class="inline">true</code>.</p></li><li><p><strong><code class="inline">args</code></strong> - Extra command line arguments to append to the &quot;erl&quot; command.
Arguments are passed as is, no escaping or quoting is needed or accepted.</p></li><li><p><strong><code class="inline">post_process_args</code></strong> - Allows the user to change the arguments passed to
<code class="inline">exec</code> before the peer is started. This can for example be useful when the
<code class="inline">exec</code> program wants the arguments to &quot;erl&quot; as a single argument. Example:</p><pre><code class="makeup erlang" translate="no"><span class="nc">peer</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="7881318135-1">(</span><span class="p" data-group-id="7881318135-2">#{</span><span class="w"> </span><span class="ss">name</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nc">peer</span><span class="p">:</span><span class="nf">random_name</span><span class="p" data-group-id="7881318135-3">(</span><span class="p" data-group-id="7881318135-3">)</span><span class="p">,</span><span class="w">
  </span><span class="ss">exec</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="7881318135-4">{</span><span class="nc">os</span><span class="p">:</span><span class="nf">find_executable</span><span class="p" data-group-id="7881318135-5">(</span><span class="s">&quot;bash&quot;</span><span class="p" data-group-id="7881318135-5">)</span><span class="p">,</span><span class="p" data-group-id="7881318135-6">[</span><span class="s">&quot;-c&quot;</span><span class="p">,</span><span class="s">&quot;erl&quot;</span><span class="p" data-group-id="7881318135-6">]</span><span class="p" data-group-id="7881318135-4">}</span><span class="p">,</span><span class="w">
  </span><span class="ss">post_process_args</span><span class="w"> </span><span class="p">=&gt;</span><span class="w">
     </span><span class="nf">fun</span><span class="p" data-group-id="7881318135-7">(</span><span class="p" data-group-id="7881318135-8">[</span><span class="s">&quot;-c&quot;</span><span class="p">|</span><span class="n">Args</span><span class="p" data-group-id="7881318135-8">]</span><span class="p" data-group-id="7881318135-7">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="7881318135-9">[</span><span class="s">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">lists</span><span class="p">:</span><span class="nf">flatten</span><span class="p" data-group-id="7881318135-10">(</span><span class="nc">lists</span><span class="p">:</span><span class="nf">join</span><span class="p" data-group-id="7881318135-11">(</span><span class="sc">$\s</span><span class="p">,</span><span class="w"> </span><span class="n">Args</span><span class="p" data-group-id="7881318135-11">)</span><span class="p" data-group-id="7881318135-10">)</span><span class="p" data-group-id="7881318135-9">]</span><span class="w"> </span><span class="k">end</span><span class="w">
  </span><span class="p" data-group-id="7881318135-2">}</span><span class="p" data-group-id="7881318135-1">)</span><span class="p">.</span></code></pre></li><li><p><strong><code class="inline">env</code></strong> - List of environment variables with their values. This list is
applied to a locally started executable. If you need to change the environment
of the remote peer, adjust <code class="inline">args</code> to contain <code class="inline">-env ENV_KEY ENV_VALUE</code>.</p></li><li><p><strong><code class="inline">wait_boot</code></strong> - Specifies the start/start_link timeout. See
<a href="#t:wait_boot/0"><code class="inline">wait_boot</code> datatype</a>.</p></li><li><p><strong><code class="inline">shutdown</code></strong> - Specifies the peer node stopping behaviour. See
<a href="#stop/1"><code class="inline">stop()</code></a>.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:wait_boot/0">

  <div class="detail-header">
    <a href="#t:wait_boot/0" class="detail-link" data-no-tooltip title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">wait_boot()</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L147" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(not exported)</span>

      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> wait_boot() :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>() | {<a href="../../apps/erts/erlang.html#t:pid/0">pid</a>(), Tag :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>()} | false.</pre>

      </div>

<p>Specifies start/start_link timeout in milliseconds. Can be set to <code class="inline">false</code>,
allowing the peer to start asynchronously. If <code class="inline">{Pid, Tag}</code> is specified instead
of a timeout, the peer will send <code class="inline">Tag</code> to the requested process.</p><p>The default is <code class="inline">15_000</code> ms.</p>
  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="call/4">

  <div class="detail-header">
    <a href="#call/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">call(Dest, Module, Function, Args)</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L463" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> call(Dest :: <a href="#t:server_ref/0">server_ref</a>(), Module :: <a href="../../apps/erts/erlang.html#t:module/0">module</a>(), Function :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(), Args :: [<a href="../../apps/erts/erlang.html#t:term/0">term</a>()]) ->
              Result :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>().</pre>

      </div>

<p>Equivalent to <a href="#call/5"><code class="inline">call(Dest, Module, Function, Args, 5000)</code></a>.</p>
  </section>
</section>
<section class="detail" id="call/5">

  <div class="detail-header">
    <a href="#call/5" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">call(Dest, Module, Function, Args, Timeout)</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L484" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> call(Dest :: <a href="#t:server_ref/0">server_ref</a>(),
           Module :: <a href="../../apps/erts/erlang.html#t:module/0">module</a>(),
           Function :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(),
           Args :: [<a href="../../apps/erts/erlang.html#t:term/0">term</a>()],
           Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>()) ->
              Result :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>().</pre>

      </div>

<p>Uses the alternative connection to evaluate
<a href="../../apps/erts/erlang.html#apply/3"><code class="inline">apply(Module, Function, Args)</code></a> on the peer node and returns the
corresponding value <code class="inline">Result</code>.</p><p><code class="inline">Timeout</code> is an integer representing the timeout in milliseconds or the atom
<code class="inline">infinity</code> which prevents the operation from ever timing out.</p><p>When an alternative connection is not requested, this function will raise <code class="inline">exit</code>
signal with the <code class="inline">noconnection</code> reason. Use <a href="../../apps/kernel/erpc.html"><code class="inline">erpc</code></a> module to communicate over
Erlang distribution.</p>
  </section>
</section>
<section class="detail" id="cast/4">

  <div class="detail-header">
    <a href="#cast/4" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">cast(Dest, Module, Function, Args)</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L507" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> cast(Dest :: <a href="#t:server_ref/0">server_ref</a>(), Module :: <a href="../../apps/erts/erlang.html#t:module/0">module</a>(), Function :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(), Args :: [<a href="../../apps/erts/erlang.html#t:term/0">term</a>()]) -> ok.</pre>

      </div>

<p>Uses the alternative connection to evaluate
<a href="../../apps/erts/erlang.html#apply/3"><code class="inline">apply(Module, Function, Args)</code></a> on the peer node. No response is
delivered to the calling process.</p><p><a href="#cast/4"><code class="inline">peer:cast/4</code></a> fails silently when the alternative connection is not configured.
Use <a href="../../apps/kernel/erpc.html"><code class="inline">erpc</code></a> module to communicate over Erlang distribution.</p>
  </section>
</section>
<section class="detail" id="get_state/1">

  <div class="detail-header">
    <a href="#get_state/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_state(Dest)</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L453" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> get_state(Dest :: <a href="#t:server_ref/0">server_ref</a>()) -> <a href="#t:peer_state/0">peer_state</a>().</pre>

      </div>

<p>Returns the peer node state.</p><p>The initial state is <code class="inline">booting</code>; the node stays in that state until then boot
script is complete, and then the node progresses to <code class="inline">running</code>. If the node stops
(gracefully or not), the state changes to <code class="inline">down</code>.</p>
  </section>
</section>
<section class="detail" id="random_name/0">

  <div class="detail-header">
    <a href="#random_name/0" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">random_name()</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L312" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> random_name() -> <a href="../../apps/erts/erlang.html#t:string/0">string</a>().</pre>

      </div>

<p>Equivalent to <a href="#random_name/1"><code class="inline">random_name(peer)</code></a>.</p>
  </section>
</section>
<section class="detail" id="random_name/1">

  <div class="detail-header">
    <a href="#random_name/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">random_name(Prefix)</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L334" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> random_name(Prefix :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>() | <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>()) -> <a href="../../apps/erts/erlang.html#t:string/0">string</a>().</pre>

      </div>

<p>Creates a sufficiently unique node name for the current host, combining a
prefix, a unique number, and the current OS process ID.</p><blockquote><h4 class="info">Note</h4><p>Use the <code class="inline">?CT_PEER([&quot;erl_arg1&quot;])</code> macro provided by Common Test
<code class="inline">-include_lib(&quot;common_test/include/ct.hrl&quot;)</code> for convenience. It starts a new
peer using Erlang distribution as the control channel, supplies thes calling
module's code path to the peer, and uses the calling function name for the
name prefix.</p></blockquote>
  </section>
</section>
<section class="detail" id="send/3">

  <div class="detail-header">
    <a href="#send/3" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">send(Dest, To, Message)</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L522" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> send(Dest :: <a href="#t:server_ref/0">server_ref</a>(), To :: <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>() | <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(), Message :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>()) -> ok.</pre>

      </div>

<p>Uses the alternative connection to send Message to a process on the the peer node.</p><p>Silently fails if no alternative connection is configured. The process can
be referenced by process ID or registered name.</p>
  </section>
</section>
<section class="detail" id="start/1">

  <div class="detail-header">
    <a href="#start/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">start(Options)</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L385" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> start(<a href="#t:start_options/0">start_options</a>()) -> {ok, <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>()} | {ok, <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>(), <a href="../../apps/erts/erlang.html#t:node/0">node</a>()} | {error, Reason}
               when Reason :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>().</pre>

      </div>

<p>Starts a peer node with the specified <a href="#t:start_options/0"><code class="inline">start_options/0</code></a>. Returns the
controlling process and the full peer node name, unless <code class="inline">wait_boot</code> is not
requested and the host name is not known in advance.</p>
  </section>
</section>
<section class="detail" id="start_link/0">

  <div class="detail-header">
    <a href="#start_link/0" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">start_link()</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L347" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> start_link() -> {ok, <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>(), <a href="../../apps/erts/erlang.html#t:node/0">node</a>()} | {error, Reason :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>()}.</pre>

      </div>

<p>The same as <a href="#start_link/1"><code class="inline">start_link(#{name =&gt; random_name()})</code></a>.</p>
  </section>
</section>
<section class="detail" id="start_link/1">

  <div class="detail-header">
    <a href="#start_link/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">start_link(Options)</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L371" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> start_link(<a href="#t:start_options/0">start_options</a>()) -> {ok, <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>()} | {ok, <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>(), <a href="../../apps/erts/erlang.html#t:node/0">node</a>()} | {error, Reason}
                    when Reason :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>().</pre>

      </div>

<p>Starts a peer node in the same way as <a href="#start/1"><code class="inline">start/1</code></a>, except that the peer node is
linked to the currently executing process. If that process terminates, the peer
node also terminates.</p><p>Accepts <a href="#t:start_options/0"><code class="inline">start_options/0</code></a>. Returns the controlling process and the full peer
node name, unless <code class="inline">wait_boot</code> is not requested and host name is not known in
advance.</p><p>When the <code class="inline">standard_io</code> alternative connection is requested, and <code class="inline">wait_boot</code> is
not set to <code class="inline">false</code>, a failed peer boot sequence causes the caller to exit with
the <code class="inline">{boot_failed, {exit_status, ExitCode}}</code> reason.</p>
  </section>
</section>
<section class="detail" id="stop/1">

  <div class="detail-header">
    <a href="#stop/1" class="detail-link" data-no-tooltip title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">stop(Dest)</h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.0/lib/stdlib/src/peer.erl#L438" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 25.0)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> stop(Dest :: <a href="#t:server_ref/0">server_ref</a>()) -> ok.</pre>

      </div>

<p>Stops a peer node. How the node is stopped depends on the
<a href="#t:start_options/0"><code class="inline">shutdown</code></a> option passed when starting the peer node.
Currently the following <code class="inline">shutdown</code> options are supported:</p><ul><li><p><strong><code class="inline">halt</code></strong> - This is the default shutdown behavior. It behaves as <code class="inline">shutdown</code>
option <code class="inline">{halt, DefaultTimeout}</code> where <code class="inline">DefaultTimeout</code> currently equals
<code class="inline">5000</code>.</p></li><li><p><strong><code class="inline">{halt, Timeout :: disconnect_timeout()}</code></strong> - Triggers a call to
<a href="../../apps/erts/erlang.html#halt/0"><code class="inline">erlang:halt()</code></a> on the peer node and then waits for the
Erlang distribution connection to the peer node to be taken down. If this
connection has not been taken down after <code class="inline">Timeout</code> milliseconds, it will
forcefully be taken down by <a href="#stop/1"><code class="inline">peer:stop/1</code></a>. See the
<a href="peer.html#dist_connection_close">warning</a> below for more info about this.</p></li><li><p><strong><code class="inline">Timeout :: disconnect_timeout()</code></strong> - Triggers a call to
<a href="../../apps/erts/init.html#stop/0"><code class="inline">init:stop()</code></a> on the peer node and then waits for the Erlang
distribution connection to the peer node to be taken down. If this connection
has not been taken down after <code class="inline">Timeout</code> milliseconds, it will forcefully be
taken down by <a href="#stop/1"><code class="inline">peer:stop/1</code></a>. See the <a href="peer.html#dist_connection_close">warning</a>
below for more info about this.</p></li><li><p><strong><code class="inline">close</code></strong> - Close the <em>control connection</em> to the peer node and return. This
is the fastest way for the caller of <a href="#stop/1"><code class="inline">peer:stop/1</code></a> to stop a peer node.</p><p>Note that if the Erlang distribution connection is not used as control
connection it might not have been taken down when <a href="#stop/1"><code class="inline">peer:stop/1</code></a> returns. Also
note that the <a href="peer.html#dist_connection_close">warning</a> below applies when the
Erlang distribution connection is used as control connection.</p></li></ul><p><a href="" id="dist_connection_close"></a></p><blockquote><h4 class="warning">Warning</h4><p>In the cases where the Erlang distribution connection is taken down by
<a href="#stop/1"><code class="inline">peer:stop/1</code></a>, other code independent of the peer code might react to the
connection loss before the peer node is stopped which might cause undesirable
effects. For example, <a href="../../apps/kernel/global.html#prevent_overlapping_partitions"><code class="inline">global</code></a>
might trigger even more Erlang distribution connections to other nodes to be
taken down. The potential undesirable effects are, however, not limited to
this. It is hard to say what the effects will be since these effects can be
caused by any code with links or monitors to something on the origin node, or
code monitoring the connection to the origin node.</p></blockquote>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="stdlib.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.32.2) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright Â© 1996-2023 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>

<script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    mermaid.initialize({
      startOnLoad: false,
      theme: document.body.className.includes("dark") ? "dark" : "default"
    });
    let id = 0;
    for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
        graphEl.innerHTML = svg;
        bindFunctions?.(graphEl);
        preEl.insertAdjacentElement("afterend", graphEl);
        preEl.remove();
      });
    }
  });
</script>

  </body>
</html>
